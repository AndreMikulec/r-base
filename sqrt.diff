--- R-3.5.1-orig/src/main/eval.c	2018-07-14 23:20:42.000000000 +0200
+++ R-3.5.1/src/main/eval.c	2018-07-14 23:25:42.000000000 +0200
@@ -4436,9 +4436,8 @@ static SEXP cmp_arith2(SEXP call, int op
    called with NA_real_. Not sure this is a bug in the Windows
    toolchain or in our expectations, but these defines attempt to work
    around this. */
-#if (defined(_WIN32) || defined(_WIN64)) && defined(__GNUC__) && \
-    __GNUC__ <= 4
-# define R_sqrt(x) (ISNAN(x) ? x : sqrt(x))
+#if (defined(_WIN32) || defined(_WIN64)) && defined(__GNUC__)
+# define R_sqrt(x) (ISNAN((double)x) ? x : sqrt(x))
 #else
 # define R_sqrt sqrt
 #endif
